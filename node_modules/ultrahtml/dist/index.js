var A=0,L=1,R=2,k=3,$=4;function X(t,n={},...o){let r={type:1,name:typeof t=="function"?t.name:t,attributes:n||{},children:o.map(e=>typeof e=="string"?{type:2,value:x(String(e))}:e),parent:void 0,loc:[]};return typeof t=="function"&&w(r,t),r}var b=Symbol("Fragment"),v=new Set(["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),S=new Set(["script","style"]),D=/([\@\.a-z0-9_\:\-]*)\s*?=?\s*?(['"]?)(.*?)\2\s+/gim,i=/(?:<(\/?)([a-zA-Z][a-zA-Z0-9\:-]*)(?:\s([^>]*?))?((?:\s*\/)?)>|(<\!\-\-)([\s\S]*?)(\-\->)|(<\!)([\s\S]*?)(>))/gm;function M(t){let n={},o;if(t)for(D.lastIndex=0,t=" "+(t||"")+" ";o=D.exec(t);)o[0]!==" "&&(n[o[1]]=o[3]);return n}function P(t){let n=typeof t=="string"?t:t.value,o,r,e,s,l,d,f,N,a,c=[];i.lastIndex=0,r=o={type:0,children:[]};let E=0;function O(){s=n.substring(E,i.lastIndex-e[0].length),s&&r.children.push({type:2,value:s,parent:r})}for(;e=i.exec(n);){if(d=e[5]||e[8],f=e[6]||e[9],N=e[7]||e[10],S.has(r.name)&&e[2]!==r.name){l=i.lastIndex-e[0].length,r.children.length>0&&(r.children[0].value+=e[0]);continue}else d==="<!--"?(l=i.lastIndex-e[0].length,a={type:3,value:f,parent:r,loc:[{start:l,end:l+d.length},{start:i.lastIndex-N.length,end:i.lastIndex}]},c.push(a),a.parent.children.push(a)):d==="<!"?(l=i.lastIndex-e[0].length,a={type:4,value:f,parent:r,loc:[{start:l,end:l+d.length},{start:i.lastIndex-N.length,end:i.lastIndex}]},c.push(a),a.parent.children.push(a)):e[1]!=="/"?(O(),a={type:1,name:e[2]+"",attributes:M(e[3]),parent:r,children:[],loc:[{start:i.lastIndex-e[0].length,end:i.lastIndex}]},c.push(a),a.parent.children.push(a),e[4]&&e[4].indexOf("/")>-1||v.has(a.name)?(a.loc[1]=a.loc[0],a.isSelfClosingTag=!0):r=a):(O(),e[2]+""===r.name?(a=r,r=a.parent,a.loc.push({start:i.lastIndex-e[0].length,end:i.lastIndex}),s=n.substring(a.loc[0].end,a.loc[1].start),a.children.length===0&&a.children.push({type:2,value:s,parent:r})):e[2]+""===c[c.length-1].name&&c[c.length-1].isSelfClosingTag===!0&&(a=c[c.length-1],a.loc.push({start:i.lastIndex-e[0].length,end:i.lastIndex})));E=i.lastIndex}return s=n.slice(E),r.children.push({type:2,value:s,parent:r}),o}var y=class{constructor(n){this.callback=n}async visit(n,o,r){if(await this.callback(n,o,r),Array.isArray(n.children)){let e=[];for(let s=0;s<n.children.length;s++){let l=n.children[s];e.push(this.visit(l,n,s))}await Promise.all(e)}}},g=class{constructor(n){this.callback=n}visit(n,o,r){if(this.callback(n,o,r),Array.isArray(n.children))for(let e=0;e<n.children.length;e++){let s=n.children[e];this.visit(s,n,e)}}},p=Symbol("HTMLString"),_=Symbol("AttrString"),h=Symbol("RenderFn");function u(t,n=[p]){let o={value:t};for(let r of n)Object.defineProperty(o,r,{value:!0,enumerable:!1,writable:!1});return o}function j(t){return u(t)}function w(t,n){return Object.defineProperty(t,h,{value:n,enumerable:!1}),t}var C={"&":"&amp;","<":"&lt;",">":"&gt;"};function x(t){return t.replace(/[&<>]/g,n=>C[n]||n)}function m(t){let n="";for(let[o,r]of Object.entries(t))n+=` ${o}="${r}"`;return u(n,[p,_])}function V(t,...n){let o="";for(let r=0;r<t.length;r++){o+=t[r];let e=n[r];o.endsWith("...")&&e&&typeof e=="object"?(o=o.slice(0,-3).trimEnd(),o+=m(e).value):e&&e[_]?(o=o.trimEnd(),o+=e.value):e&&e[p]?o+=e.value:typeof e=="string"?o+=x(e):(e||e===0)&&(o+=String(e))}return u(o)}function F(t,n){return new y(n).visit(t)}function H(t,n){return new g(n).visit(t)}async function I(t){let{name:n,attributes:o={}}=t,r=await Promise.all(t.children.map(e=>T(e))).then(e=>e.join(""));if(h in t){let e=await t[h](o,u(r));return e&&e[p]?e.value:x(String(e))}return n===b?r:v.has(n)?`<${t.name}${m(o).value}>`:`<${t.name}${m(o).value}>${r}</${t.name}>`}async function T(t){switch(t.type){case 0:return Promise.all(t.children.map(n=>T(n))).then(n=>n.join(""));case 1:return I(t);case 2:return`${t.value}`;case 3:return`<!--${t.value}-->`;case 4:return`<!${t.value}>`}}async function U(t,n=[]){if(!Array.isArray(n))throw new Error(`Invalid second argument for \`transform\`! Expected \`Transformer[]\` but got \`${typeof n}\``);let r=typeof t=="string"?P(t):t;for(let e of n)r=await e(r);return T(r)}export{k as COMMENT_NODE,$ as DOCTYPE_NODE,A as DOCUMENT_NODE,L as ELEMENT_NODE,b as Fragment,h as RenderFn,R as TEXT_NODE,j as __unsafeHTML,w as __unsafeRenderFn,m as attrs,X as h,V as html,P as parse,T as render,U as transform,F as walk,H as walkSync};
